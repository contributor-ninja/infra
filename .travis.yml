language: go
go:
- 1.10.3
before_install:
- wget https://s3.amazonaws.com/up-dlmirror/up
- wget https://s3.amazonaws.com/up-dlmirror/apex
- chmod +x up apex
install:
- "./up version"
- go get ./...
before_deploy:
- cat project.json.tpl | envsubst > project.json
- cat api/index/up.json.tpl | envsubst > api/index/up.json
deploy:
- provider: script
  script: ./apex deploy
  skip_cleanup: true
  on:
    branch: master
- provider: script
  script: bash scripts/deploy.sh api/index
  skip_cleanup: true
  on:
    branch: master
env:
  global:
  - AWS_REGION=us-east-1
  - secure: GRUJrFHcpREufYKEm5eXAQb72NdyG9AOcs7kel7pw5Uru4/TmduGzx2jYjtIfVHLkZzB7lx7hkmEdy4NEMuIU+93Zn71HmPvLBqJwy8IMk75KgdnHbIw8CNwA+UFrxgls+7IGfEMbhu/Bw3bt2wjUISMIHIYwDbCP2M0tQR4PVKfUxIRojwzJkD+kKzTRkBwfWU7H1ALpNi8sicT8dKfOf482UJG9Csq18NCXtpFyi+8EcEqAm+QQk+z1VFVMOgIk0nHrdKoVKbvX7lb6rFesH+dw8WWqieEcBGxVzwWittVrIyody6G8GO1TaCPKgu897wW1/+JPFiTYnKcGhPDF6o4Pr8uXDhbA6QXKInGRIeVcBEtYr+yotuhItCYgmuyCLOOTTjDQPAJiFXLwwN3t7XzMzLFOpI4Q/PbmX2QK0nmLX79OOa5L/2xs6o6ZltNsxWIAlYhSmMZufOB4E0Zp992tFEHPCkh0QdNAMIsaAYhXsw2XmXUqamxjCz6pROK/Ksxt3aSF0mjv1qt0XFdkG5/t9HiJ1TGkI3iC7CI/2U0+bzey2xRKYFcT95TabibOLwzwpN5Zhhfih2JAyUSGObIT1nKYkQnetfR8ZMR/p2lJJtC7RmcjTOzBgo9YgLgSmgZXZ8U/3GnVXzNliCJ3yyEIC0svlHckH4eJ1ddiaI=
  - secure: jYPA38CBtqhHhGdUSxvCPJz/yIfkiBavMKuldEZMVpMZXPsyMywPDNRa9gd3S7zHez5arKplLX93NaoomjrdCZJDSbwAVO160XLcx1nvdlxnDkDs54M6jFhIdbAzfD4KPFpCCyYXw7vU8oXBHYcbhJqZqA76RsK3nkYghbNO6Jk1C2nRKgqKYxNcDW+E5yQSwp9fx5g5qXXj42xoZnYPL5aOV7/aat57cQ7ulbGMpjoQ6wfgq2VoHxJ+akmXNsRuGAdnDB69ixigi42xMDy4xSNZZX+OIMpRwSN7ywhtqvHl+Yu13fePgc8ktsUvohJh5kMbO93lttIF8nsEtNnAT510kC1SRPh8oCD6NsaZKu9B1t9QpWtAwzhBMrdMeVfXf5h0iSstLIzx/x47cvM1liKUqYUotoIlHRdY6fKSZVqIs5r2IA6ovAPe7F70AxIWZfq4ZxRy8guwuwW9SHwmq2JN5K7vYMy9a7RFBcJDHGLko3z0zxnnrww9Useo46OriwIT/QpP//bGWrsg+wjXXBObAx9N/lWRAdbRTD+kUTJTumopBeL15CWlgbjUY2TYaYkCdvfGtZpJl8QEGWun01T/N0ZaD4A8PS7mDIkQ8EpFSK5aY3qg9yzpgf14EabkJG4m0yigEr/K7oDRKRkIGZotXprpF2aZoqS/BW5SEUs=
  - secure: cW1J0pw+3h1XfJRlk07b8nL7LaP+pwkwFO/QWNF7hiu1zg++bc80F8/Vh+d4ao7LShoTW84gpGcVKbQOnBeo7FZAd15dtGAKvSUhjJueFCmRFvalggN4sY+m8mR+icozc0QiqaypVSjMDVvCC2HRUHY9QtbK5S1vxX/at060q0N3wNzZoMTMyK2aBzNss9lyq6wEr3GTeU1/bv17QZDJtgQXvzADS0IGTcG/O5HOUvr7oDbi5glHcr8wY+w1MdtIbjyb0frnmbkKy3Uxsxduib9t58KSZhLKfgImPKGgnZhLKFKm02nCPH3OyXGjqIvGbj5PrcnFmyWLVOnX+cerMUJUkGTlPsXrt01bi637ikLZHDlZ+eYMVA/PVGvPF37UNvQjSjeiOMOWDPIK0SiG7vRugykBNhvm12bXYxewfue6thHlxXh1+bvR6CkQ2sNWmdBOBHb1oFTYprj6aVXOgdgOsg2YiuN+2Om4/za0c67eP17/zFwSNbOATDDimO8tIu8Zx5i3OTkzIYatgd1KWwjU/avSHrM19wCWAia1gqqvhWmLINY9cuvUZw/NFuFpFxUgPyZZiH58lwOVLKZ/T0azQSI0JutVfX8eYWYclp19cFE7XrX5JzaD8/lmwLgs+yuQGHaELCTsTU9ENYuw2NbOdzJ+w2QZEur2nGRHoHY=
  - secure: etjEjM9EDP7ROrqHGIxUryuRO//9zGNDqnU56eS2LWsZkcj6TTysg6UX9NZTCgK3lMSIDcfUsTVN+hwcskkM/rvWGFlCXOthUugvL9V4zPdR05zOB3z9ewzgWLJ5kpO/pmMp+nzFxb/KLULAJA6kiMBtS/dB2VXdgwmXdzR6QoC6dV/+u/ue/FkOLfTQLunoYWh7UxZiGBzpotj9wrUUUpgqgRFW5tbbxm10vOPzSvcoIxerhTfDMEdm572jr/kd8CMpO2JbAsMdOhuATPkJwswNy8TGZdkFs8vB79o/AMQ0hiL6P9UMoFMqXSyRo1EqgCmUQnZeRmfBzsS6UCs24OmdASp+2c3lSeaD2oEgKDAd0ydRwP1tB46Eas56mRCzqaxKQmbVUOoGjUhZJwOdhUjljQUQBgEKefjcXCP70Y5eFCNy6eVPIStIyeEmHrsSxXwiEPj3js8UZghrAAa9TkRpS/xkjAZC+oEUfrBSGnHDamYOzohp9n+rsBrnY8j2kTidyZBYtGNpMbrKvojy3mSFxfb8XrRrAvoxwn/HiyCmSRc9b0bpReyaeQ4P8aKYagvol4knA/DJpAwrnwp50h+c5zPNK9t5MHi0nzwZKeNiARyoRWDeNgCMdDUH1vbjx6PCTkPX7x+HexgLakTIFT4Sj48ymSJdd+owNLO797A=
  - secure: f+Bhpl0ngDkxpCkpieb8If9REvWP0aFQq8tYfkF83vX62yv89VpBzwnwGQNgOw7km4R7IgfeoFEQN5Gyt/UHeW5KpBr7vIECtBZiYNSTnHKS0TrsCsl9pmHPHD/CmWucqvPTIiKgev8jWHuKycKVP/eaKwJGKao11PqFeDTKXG4q9BrkE+/G4hVSBQ3UTgW8roilYhW/qy9Feh4/A70TCMVs1/WW6+QCNkezSe5bsMA1bB/rRMCx8dNZBbtl9lF6OTZtJ1qrhCZmREnz938HgyuN9Qd6N1Kk/jwfKQrJFDL3+x56vdkW4c/nwmDa6echDyWD8xnUEVwmMHuWVerQIWqKmbKkFxa6a2pdEL6B6pc7v0dCOI7lBpRjdmPKc0cPazmuHe/A1FU5NquPlSLQ0aU15kdD6XqCzxDzcoKkrGu55hmD6YrZY4MHOfSXF2fbYTkV1d+H/glyg/6W7UUhO4K9cERgkCFZHC2XDluv3L7iPKvAoFNcppwF9Zwy+wTjl11BbojxGkyzt5CgeroRyFVwtwuGeawc8pPGAldpdqTlFwImmo9L9TC7MzguINp3Q4zBaMjCeqfu2fCkUGef9+HnqXmDQfDZrWSW92ga8N5MWkD9iCH2otIJU8nB+sZDbxqmlSWq685HILe8OVAQSPCOK/xgAS0MH5c9RM/nyEM=
